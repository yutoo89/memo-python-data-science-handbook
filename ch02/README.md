# NumPyの基礎

ドキュメント、画像、サウンドクリップ、数値測定結果など、すべてのデータを数値の配列として扱う。
NumPyは、Numerical Pythonの略。

## データ型

Pythonは動的型付け言語で、変数のデータ型を明示的に宣言しなくても、自動的に推測される。

```python
result = 0
for i range(100)
  result += i
```

type関数で変数の型を確認することができる。

```bash
In [12]: type(result)
Out[12]: int
```

### 整数

Cの整数は、整数値を格納するメモリ内の位置のラベル。
しかしPythonの整数は、整数値を格納するデータを含むPythonオブジェクト情報を格納するメモリ内の位置のポインタ。
これによりPythonではより柔軟にコーディングできるようになるが、同時にオーバーヘッドでもある。

### リスト

リストはPythonの標準的なコンテナで、可変個の要素を格納する。

```bash
In [13]: l = list(range(10))

In [14]: l
Out[14]: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
```

動的型付けにより、異なる型の要素をひとつのリストに格納できる。

```bash
In [16]: l = [True, "2", 3.0, 4]

In [17]: [type(item) for item in l]
Out[17]: [bool, str, float, int]
```

しかし、これを実現するためには、各要素が独自に型や参照数を持つ必要があるため、コストがかかる。
すべての変数が同じ型であるケースでは、これらの情報は冗長なので、固定型配列に格納した方が効率的。

配列は連続したデータブロックへのポイントだが、リストはポインタ列へのポインタで、ポインタ列のポインタは、完全なPythonオブジェクトを指している。

## 固定型配列

配列モジュールarrayはPython3.3から利用可能になった。
次のように型が同一の配列を作成する。

```bash
In [18]: import array

In [19]: l = list(range(10))

In [20]: a = array.array('i', l)

In [21]: a
Out[21]: array('i', [0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
```

NumPyパッケージのndarrayを使って、Pythonリストから配列を作成する例。
numpyをインポートする際、監修的にnpという別名をつけるらしい。

```bash
In [26]: import numpy as np
    ...: np.array([1, 4, 2, 5, 3])
Out[26]: array([1, 4, 2, 5, 3])
```

NumPy配列の要素は、すべて同じ型である必要があるため、たとえば整数の配列に浮動小数点があると、整数は浮動小数点にアップキャストされる。

```bash
In [27]: import numpy as np
    ...: np.array([1, 4, 2, 5, 3.14])
Out[27]: array([1.  , 4.  , 2.  , 5.  , 3.14])
```

NumPy配列は、リストのリストを使用して多次元配列を作ることもできる。

```bash
In [28]: np.array([range(i, i + 3) for i in [2, 4, 6]])
Out[28]: 
array([[2, 3, 4],
       [4, 5, 6],
       [6, 7, 8]])
```

NumPyに組み込まれた関数を使って、次のような配列を作ることができる。
多次元配列も第一引数で行数と列数を指定して作ることができる。

```bash
# 要素が0である長さ10の配列
In [30]: np.zeros(10, dtype=int)
Out[30]: array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0])

# 要素が1である3行5列の配列
In [31]: np.ones((3, 5), dtype=float)
Out[31]: 
array([[1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.],
       [1., 1., 1., 1., 1.]])

# 要素が3.14である3行5列の配列
In [32]: np.full((3, 5), 3.14)
Out[32]: 
array([[3.14, 3.14, 3.14, 3.14, 3.14],
       [3.14, 3.14, 3.14, 3.14, 3.14],
       [3.14, 3.14, 3.14, 3.14, 3.14]])

# 開始値0、終了値20で2ずつ増加する配列
In [34]: np.arange(0, 20, 2)
Out[34]: array([ 0,  2,  4,  6,  8, 10, 12, 14, 16, 18])

# 最小値0、最大値10で差が均等な5つの要素の配列
In [35]: np.linspace(0, 10, 5)
Out[35]: array([ 0. ,  2.5,  5. ,  7.5, 10. ])

# 最小値0、最大値1の間に分布したランダムな値の配列
In [36]: np.random.random((3, 3))
Out[36]: 
array([[0.51945132, 0.52146822, 0.52597043],
       [0.75445209, 0.91722423, 0.76609237],
       [0.96959243, 0.75895462, 0.97508106]])

# 平均0、標準偏差1の正規分布乱数の配列
In [38]: np.random.normal(0, 1, (3, 3))
Out[38]: 
array([[ 0.95584542,  0.50367991, -0.71427953],
       [ 1.48224292, -0.07371263, -0.46092532],
       [-0.40134372,  0.97331877, -1.18272122]])

# 0~10のランダムな数字の配列
In [40]: np.random.randint(0, 10, (3, 3))
Out[40]: 
array([[3, 6, 0],
       [1, 7, 5],
       [9, 3, 9]])

# 3行3列の単位行列
# 単位行列は、行列の対角の成分がすべて1、それ以外の成分が0の行列
# 単位行列と任意の行列の積は、任意の行列のままになる
# 単位行列を作る関数がなぜeyeなのか => Identity matrix（単位行列）の音が由来？
In [41]: np.eye(3)
Out[41]: 
array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.]])

# 3つの整数の初期化されていない配列
# 各要素の値は、そのメモリ位置にすでに存在していたものになる
In [42]: np.empty(3)
Out[42]: array([1., 1., 1.])
```

## NumPyのデータ型

NumPyはC言語で実装されている。
配列を作るときにdtypeでデータ型を指定することができる。

> NumPyは、Pythonよりもはるかに多様な数値型をサポートしています。このセクションでは、使用可能なものと、配列のデータ型を変更する方法を示します。
> サポートされているプリミティブ型は、C言語のものと密接に結びついています。
> https://runebook.dev/ja/docs/numpy/user/basics.types

```bash
In [44]: np.zeros(10, dtype="int16")
Out[44]: array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0], dtype=int16)
```

- int8	
  - i1
  - 符号あり8ビット整数型
- int16	
  - i2
  - 符号あり16ビット整数型
- int32	
  - i4
  - 符号あり32ビット整数型
- int64	
  - i8
  - 符号あり64ビット整数型
- uint8	
  - u1
  - 符号なし8ビット整数型
- uint16	
  - u2
  - 符号なし16ビット整数型
- uint32	
  - u4
  - 符号なし32ビット整数型
- uint64	
  - u8
  - 符号なし64ビット整数型
- float16	
  - f2
  - 半精度浮動小数点型（符号部1ビット、指数部5ビット、仮数部10ビット）
- float32	
  - f4
  - 単精度浮動小数点型（符号部1ビット、指数部8ビット、仮数部23ビット）
- float64	
  - f8
  - 倍精度浮動小数点型（符号部1ビット、指数部11ビット、仮数部52ビット）
- float128	
  - f16
  - 四倍精度浮動小数点型（符号部1ビット、指数部15ビット、仮数部112ビット）
- complex64	
  - c8
  - 複素数（実部・虚部がそれぞれfloat32）
- complex128	
  - c16
  - 複素数（実部・虚部がそれぞれfloat64）
- complex256	
  - c32
  - 複素数（実部・虚部がそれぞれfloat128）
- bool	
  - ?
  - ブール型（True or False）
- unicode	
  - U
  - Unicode文字列
- object	
  - O
  - Pythonオブジェクト型

